# 如何在Mac上打包Windows exe - 三种方案

## 方案对比

| 方案 | 难度 | 时间 | 适用场景 |
|------|------|------|----------|
| 方案1：GitHub自动打包 | ⭐ 简单 | 5分钟 | **强烈推荐！最简单** |
| 方案2：使用Wine打包 | ⭐⭐⭐ 复杂 | 30分钟+ | 纯离线环境 |
| 方案3：在Windows上打包 | ⭐⭐ 中等 | 10分钟 | 有Windows电脑 |

---

## 🌟 方案1：GitHub自动打包（最推荐，5分钟搞定）

**优点：**
- ✅ 最简单，只需3步
- ✅ 不需要安装任何额外软件
- ✅ 自动生成Windows exe
- ✅ 可以在任何设备下载

**步骤：**

### 第1步：创建GitHub仓库
1. 访问 https://github.com/new
2. 创建一个新仓库（比如命名为 `excel-filter-tool`）
3. 上传所有文件（可以拖拽上传）

### 第2步：触发构建
1. 在仓库页面点击 "Actions" 标签
2. 选择 "Build Windows EXE" 工作流
3. 点击 "Run workflow" → "Run workflow" 按钮
4. 等待1-2分钟

### 第3步：下载exe
1. 构建完成后，进入构建详情页
2. 在 "Artifacts" 部分下载 `Excel数据筛选工具-Windows`
3. 解压zip文件，里面就是exe文件

**就这么简单！** 🎉

---

## 🍷 方案2：使用Wine在Mac上打包（较复杂）

**适用场景：** 没有GitHub账号，需要完全离线操作

**步骤：**

### 2.1 安装Wine
```bash
# 安装Homebrew（如果未安装）
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装Wine
brew install --cask wine-stable
```

### 2.2 下载Windows版Python
1. 访问 https://www.python.org/downloads/windows/
2. 下载 "Windows embeddable package (64-bit)"
3. 解压到 `~/Downloads/python_windows`

### 2.3 安装Python到Wine
```bash
# 创建Wine环境
export WINEPREFIX=~/.wine_pyinstaller
wineboot -i

# 复制Python
mkdir -p ~/.wine_pyinstaller/drive_c/python
cp -r ~/Downloads/python_windows/* ~/.wine_pyinstaller/drive_c/python/

# 安装pip
curl https://bootstrap.pypa.io/get-pip.py -o /tmp/get-pip.py
wine ~/.wine_pyinstaller/drive_c/python/python.exe /tmp/get-pip.py

# 安装依赖
wine ~/.wine_pyinstaller/drive_c/python/Scripts/pip.exe install openpyxl pyinstaller
```

### 2.4 打包
```bash
cd /Users/songjinfeng/Desktop/shuju
bash build_with_wine.sh
```

**注意：** 此过程较复杂，如遇问题请参考 `Mac打包Windows版exe指南.md`

---

## 🪟 方案3：在Windows电脑上打包（中等难度）

**步骤：**
1. 将以下文件复制到Windows电脑：
   - excel_filter_tool.py
   - requirements.txt
   - build.bat

2. 在Windows上安装Python：https://www.python.org/downloads/

3. 双击运行 `build.bat`

4. 等待完成，在 `dist` 文件夹获得exe

---

## ❓ 常见问题

### Q: 我该选哪个方案？
**A:**
- 如果想要最简单 → **方案1（GitHub）**
- 如果有Windows电脑 → 方案3
- 如果必须离线且只有Mac → 方案2

### Q: 打包出来的exe有多大？
**A:** 大约 15-20 MB

### Q: 需要在目标电脑安装Python吗？
**A:** 不需要！exe文件是独立的，可以直接运行

### Q: Windows杀毒软件会报毒吗？
**A:** PyInstaller打包的程序可能被误报，可以添加信任

---

## 📁 最终文件结构

完成打包后，您将得到：
```
dist/
└── Excel数据筛选工具.exe  ← 这就是要拷贝到Windows的文件
```

直接将这个exe文件拷贝到U盘，在任何Windows电脑上双击运行即可！

---

## 🚀 推荐操作流程

**如果您现在就想获得exe文件：**

1️⃣ **首选：使用方案1（GitHub）**
   - 创建GitHub仓库
   - 上传文件
   - 点击Actions运行
   - 5分钟后下载exe

2️⃣ **备选：找台Windows电脑**
   - 运行build.bat
   - 立即得到exe

3️⃣ **最后选择：在Mac上装Wine**
   - 比较复杂，需要30分钟+
   - 适合纯离线场景

需要我帮您详细说明某个方案吗？
